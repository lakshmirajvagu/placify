import{r as i,d as H,u as O,j as e,b as j,B as C}from"./index-BW9J8XDZ.js";import{B as R}from"./Button-DwHs9q8a.js";import{F as d,a as c}from"./Form-B79OQcrp.js";import{C as z}from"./Toast-B3EGjjVm.js";import{M as L}from"./Modal-C3czwkNW.js";import"./ThemeProvider-CkxvoxuK.js";import"./Button-2RoaZ0va.js";import"./useTimeout-C4AjoZ0W.js";import"./TransitionWrapper-C8SpBI9G.js";import"./Col-ybKDMb82.js";import"./useEventCallback-Duh4GctK.js";import"./hasClass-Cxr2nBO8.js";function te(){document.title="CPMS | Add Internships";const[N,I]=i.useState(!0),{internshipId:y}=H(),F=O(),[M,h]=i.useState(!1),[T,m]=i.useState(""),[A,f]=i.useState(!1),[b,S]=i.useState(""),$=()=>f(!1),[t,v]=i.useState({}),[o,k]=i.useState("");i.useEffect(()=>{(async()=>{try{const l=localStorage.getItem("token"),p=await j.get(`${C}/user/detail`,{headers:{Authorization:`Bearer ${l}`}});k({id:p.data.id}),y||I(!1)}catch(l){console.log("addinternship.jsx => ",l)}})()},[]);const B=async()=>{var s,l,p,u,g,x;try{if(!(o!=null&&o.id)||!y)return;const n=await j.get(`${C}/student/internship?studentId=${o==null?void 0:o.id}&internshipId=${y}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});v(n.data.internship),S(n.data.internship.companyName),(s=n==null?void 0:n.data)!=null&&s.msg&&(m((l=n==null?void 0:n.data)==null?void 0:l.msg),h(!0))}catch(n){console.log("error while updating internship ",n),(u=(p=n.response)==null?void 0:p.data)!=null&&u.msg?m((x=(g=n==null?void 0:n.response)==null?void 0:g.data)==null?void 0:x.msg):m("Error while updating internship please try again later!"),h(!0)}finally{I(!1)}},r=s=>{v({...t,[s.target.name]:s.target.value}),s.target.name==="companyName"&&S(s.target.value)},D=s=>!s||s==="undefined"?"":new Date(s).toISOString().split("T")[0],E=()=>{if(!(t!=null&&t.companyName)||!(t!=null&&t.internshipDuration)||!(t!=null&&t.startDate)||!(t!=null&&t.type)){m("Star Marked Required!"),h(!0);return}f(!0)},P=async()=>{var s,l,p,u,g,x,n,w;try{const a=await j.post(`${C}/student/update-internship?studentId=${o==null?void 0:o.id}&internshipId=${y}`,{internship:t},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if((s=a==null?void 0:a.data)!=null&&s.msg&&(m((l=a==null?void 0:a.data)==null?void 0:l.msg),h(!0),((p=a==null?void 0:a.data)==null?void 0:p.msg)==="Internship Updated Successfully!")){const W={showToastPass:!0,toastMessagePass:(u=a==null?void 0:a.data)==null?void 0:u.msg};F("/student/internship",{state:W})}}catch(a){console.log("error while updating internship ",a),(x=(g=a.response)==null?void 0:g.data)!=null&&x.msg?m((w=(n=a==null?void 0:a.response)==null?void 0:n.data)==null?void 0:w.msg):m("Error while updating internship please try again later!"),h(!0)}f(!1)};return i.useEffect(()=>{B()},[o==null?void 0:o.id]),e.jsxs(e.Fragment,{children:[e.jsx(z,{show:M,onClose:()=>h(!1),message:T,delay:3e3,position:"bottom-end"}),N?e.jsx("div",{className:"flex justify-center h-72 items-center",children:e.jsx("i",{className:"fa-solid fa-spinner fa-spin text-3xl"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"my-8 backdrop-blur-md bg-white/30 border border-white/20 rounded-lg shadow shadow-red-400 p-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 max-sm:grid-cols-1",children:[e.jsx(d,{controlId:"floatingCompanyName",label:e.jsx(e.Fragment,{children:e.jsxs("span",{children:["Company Name ",e.jsx("span",{style:{color:"red"},children:"*"})]})}),children:e.jsx(c.Control,{type:"text",placeholder:"Company Name",name:"companyName",value:(t==null?void 0:t.companyName)||"",onChange:r})}),e.jsx(d,{controlId:"floatingCompanyWebsite",label:"Company Website",children:e.jsx(c.Control,{type:"link",placeholder:"Company Website",name:"companyWebsite",value:(t==null?void 0:t.companyWebsite)||"",onChange:r})}),e.jsx(d,{controlId:"floatingInternshipDuration",label:e.jsx(e.Fragment,{children:e.jsxs("span",{children:["Internship Duration In Days ",e.jsx("span",{style:{color:"red"},children:"*"})]})}),children:e.jsx(c.Control,{type:"number",step:1,placeholder:"Internship Duration",name:"internshipDuration",value:(t==null?void 0:t.internshipDuration)||"",onChange:r})}),e.jsx(d,{controlId:"floatingMonthlyStipend",label:"Monthly Stipend in Rupees",children:e.jsx(c.Control,{type:"number",step:500,placeholder:"Monthly Stipend in Rupees",name:"monthlyStipend",value:(t==null?void 0:t.monthlyStipend)||"",onChange:r})}),e.jsx(d,{controlId:"floatingStartDate",label:e.jsx(e.Fragment,{children:e.jsxs("span",{children:["Internship Start Date ",e.jsx("span",{style:{color:"red"},children:"*"})]})}),children:e.jsx(c.Control,{type:"date",placeholder:"Internship Start Date",name:"startDate",value:D(t==null?void 0:t.startDate)||"",onChange:r})}),e.jsx(d,{controlId:"floatingEndDate",label:"End Date",children:e.jsx(c.Control,{type:"date",placeholder:"Internship End Date",name:"endDate",value:D(t==null?void 0:t.endDate)||"",onChange:r})}),e.jsx(d,{controlId:"floatingSelectType",label:e.jsx(e.Fragment,{children:e.jsxs("span",{children:["Select Internship Type ",e.jsx("span",{style:{color:"red"},children:"*"})]})}),children:e.jsxs(c.Select,{"aria-label":"Floating label select internship type",className:"cursor-pointer",name:"type",value:(t==null?void 0:t.type)||"undefined",onChange:r,children:[e.jsx("option",{disabled:!0,value:"undefined",className:"text-gray-400",children:"Select Internship Type"}),e.jsx("option",{value:"Full Time",children:"Full Time"}),e.jsx("option",{value:"Part Time",children:"Part Time"}),e.jsx("option",{value:"On-Site",children:"On-Site"}),e.jsx("option",{value:"Work From Home",children:"Work From Home"}),e.jsx("option",{value:"Other",children:"Other"})]})}),e.jsx(d,{controlId:"floatingCompanyAddress",label:"Company Address",children:e.jsx(c.Control,{as:"textarea",placeholder:"Company Address",name:"companyAddress",style:{maxHeight:"200px"},value:(t==null?void 0:t.companyAddress)||"",onChange:r})}),e.jsx("div",{className:"col-span-2 max-sm:col-span-1",children:e.jsx(d,{controlId:"floatingDescription",label:"Internship Description",children:e.jsx(c.Control,{as:"textarea",placeholder:"Internship Description",name:"description",style:{maxHeight:"350px",minHeight:"150px"},value:(t==null?void 0:t.description)||"",onChange:r})})})]})}),e.jsx("div",{className:"flex flex-col justify-center items-center gap-2",children:e.jsx(R,{variant:"primary",type:"submit",size:"lg",onClick:E,children:"Update"})})]}),e.jsx(L,{show:A,close:$,header:"Confirmation",body:`Do you add internship ${b?`of ${b}`:""}?`,btn:"Update",confirmAction:P})]})}export{te as default};
