import{d as F,r as c,b as f,B as b,j as e,c as v}from"./index-BW9J8XDZ.js";import{A as h}from"./Accordion-QbAzgRVx.js";import{T as O}from"./Table-BMev4Dnk.js";import{C as U}from"./Toast-B3EGjjVm.js";import{B as A}from"./Button-DwHs9q8a.js";import{M as W}from"./Modal-C3czwkNW.js";import"./ThemeProvider-CkxvoxuK.js";import"./hook-DYghO068.js";import"./TransitionWrapper-C8SpBI9G.js";import"./useTimeout-C4AjoZ0W.js";import"./useEventCallback-Duh4GctK.js";import"./Button-2RoaZ0va.js";import"./hasClass-Cxr2nBO8.js";function de(){var N;document.title="CPMS | View Job Post";const{jobId:x}=F(),[l,S]=c.useState({}),[t,D]=c.useState(null),[$,k]=c.useState(!0),[C,u]=c.useState(!1),[L,m]=c.useState(""),[d,M]=c.useState({}),[y,T]=c.useState(!1),[j,B]=c.useState([]),w=async()=>{var s,a,n,i,p;try{const o=await f.get(`${b}/student/check-applied/${x}/${d.id}`);(s=o==null?void 0:o.data)!=null&&s.applied&&T((a=o==null?void 0:o.data)==null?void 0:a.applied)}catch(o){(i=(n=o==null?void 0:o.response)==null?void 0:n.data)!=null&&i.msg&&(m((p=response==null?void 0:response.data)==null?void 0:p.msg),u(!0)),console.log("error while fetching student applied or not => ",o)}};c.useEffect(()=>{const s=localStorage.getItem("token");f.get(`${b}/user/detail`,{headers:{Authorization:`Bearer ${s}`}}).then(a=>{M({id:a.data.id,email:a.data.email,role:a.data.role})}).catch(a=>{console.log("AddUserTable.jsx => ",a),m(a),u(!0)})},[]);const I=async()=>{var s,a,n;try{const i=await f.get(`${b}/tpo/job/${x}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});S(i.data)}catch(i){i.response&&((s=i==null?void 0:i.response.data)!=null&&s.msg?m(i.response.data.msg):m(i.message),u(!0),((n=(a=i==null?void 0:i.response)==null?void 0:a.data)==null?void 0:n.msg)==="job data not found"&&navigate("../404")),console.log("Error while fetching details => ",i)}},_=async()=>{try{const s=await f.get(`${b}/company/company-data?companyId=${l.company}`);D(s.data.company)}catch(s){console.log("AddCompany error while fetching => ",s)}},[E,g]=c.useState(!1),[H,J]=c.useState(),K=()=>{g(!1)},P=()=>{J("Do you really want to apply this job? Make sure your profile is updated to lastest that increase placement chances."),g(!0)},R=async()=>{var s,a,n,i,p,o;try{const r=await f.put(`${b}/student/job/${x}/${d.id}`);(s=r==null?void 0:r.data)!=null&&s.msg&&(m((a=r==null?void 0:r.data)==null?void 0:a.msg),u(!0)),g(!1),w()}catch(r){g(!1),(i=(n=r==null?void 0:r.response)==null?void 0:n.data)!=null&&i.msg&&(m((o=(p=r==null?void 0:r.response)==null?void 0:p.data)==null?void 0:o.msg),u(!0)),console.log("error while fetching apply to job => ",r)}},z=async()=>{!x||(d==null?void 0:d.role)==="student"||await f.get(`${b}/tpo/job/applicants/${x}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(s=>{var a,n;(a=s==null?void 0:s.data)!=null&&a.msg?m(s.data.msg):B((n=s==null?void 0:s.data)==null?void 0:n.applicantsList)}).catch(s=>{var a,n;console.log(s),(n=(a=s==null?void 0:s.response)==null?void 0:a.data)!=null&&n.msg&&m(s.response.data.msg)})};return c.useEffect(()=>{(async()=>{try{await w(),l!=null&&l.company&&await _(),d.id&&await I(),x&&await z()}catch(a){console.error("Error during fetching and applying job:",a)}k(!1)})()},[d,l==null?void 0:l.company,x]),e.jsxs(e.Fragment,{children:[e.jsx(U,{show:C,onClose:()=>u(!1),message:L,delay:3e3,position:"bottom-end"}),$?e.jsx("div",{className:"flex justify-center h-72 items-center",children:e.jsx("i",{className:"fa-solid fa-spinner fa-spin text-3xl"})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 my-6 text-base max-sm:text-sm max-sm:grid-cols-1",children:[e.jsxs("div",{className:"flex flex-col grid-flow-row-dense gap-2",children:[e.jsx("div",{className:"",children:e.jsx(h,{defaultActiveKey:["0"],alwaysOpen:!0,className:"shadow rounded",children:e.jsxs(h.Item,{eventKey:"0",children:[e.jsx(h.Header,{children:"Company Details"}),e.jsx(h.Body,{children:e.jsxs("div",{className:"",children:[e.jsx("h3",{className:"text-3xl text-center border-b-2 py-4 mb-4",children:t==null?void 0:t.companyName}),e.jsx("div",{className:"border-b-2 px-2 pb-4 text-gray-500 text-justify leading-5",children:t==null?void 0:t.companyDescription}),e.jsxs("div",{className:"flex justify-between p-2 border-b-2 my-2",children:[e.jsx("span",{children:"Website"}),e.jsx("span",{className:"bg-blue-500 py-1 px-2 text-white rounded cursor-pointer",children:e.jsx("a",{href:`${t==null?void 0:t.companyWebsite}`,target:"_blanck",className:"no-underline text-white",children:t==null?void 0:t.companyWebsite})})]}),e.jsxs("div",{className:"flex justify-between p-2 border-b-2 my-2",children:[e.jsx("span",{children:"Job Locations"}),e.jsx("div",{className:"flex gap-2",children:(N=t==null?void 0:t.companyLocation)==null?void 0:N.split(",").map((s,a)=>e.jsx("span",{className:"bg-blue-500 py-1 px-2 text-white rounded",children:s.trim()},a))})]}),e.jsxs("div",{className:"flex justify-between p-2 border-b-2 my-2",children:[e.jsx("span",{children:"Difficulty Level"}),(t==null?void 0:t.companyDifficulty)==="Easy"&&e.jsx("span",{className:"bg-green-500 py-1 px-2 text-white rounded",children:t==null?void 0:t.companyDifficulty}),(t==null?void 0:t.companyDifficulty)==="Moderate"&&e.jsx("span",{className:"bg-orange-500 py-1 px-2 text-white rounded",children:t==null?void 0:t.companyDifficulty}),(t==null?void 0:t.companyDifficulty)==="Hard"&&e.jsx("span",{className:"bg-red-500 py-1 px-2 text-white rounded",children:t==null?void 0:t.companyDifficulty})]})]})})]})})}),d.role!=="student"&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"",children:e.jsx(h,{defaultActiveKey:["3"],alwaysOpen:!0,className:"shadow rounded",children:e.jsxs(h.Item,{eventKey:"3",children:[e.jsx(h.Header,{children:"Applicants Applied"}),e.jsx(h.Body,{children:e.jsxs(O,{striped:!0,bordered:!0,hover:!0,size:"sm",className:"text-center",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"10%"},children:"#"}),e.jsx("th",{style:{width:"20%"},children:"Name"}),e.jsx("th",{style:{width:"15%"},children:"Email"}),e.jsx("th",{style:{width:"20%"},children:"Current Round"}),e.jsx("th",{style:{width:"15%"},children:"Status"}),e.jsx("th",{style:{width:"20%"},children:"Applied On"})]})}),e.jsx("tbody",{children:(j==null?void 0:j.length)>0?e.jsx(e.Fragment,{children:j.map((s,a)=>{var n,i,p;return e.jsxs("tr",{children:[e.jsx("td",{children:a+1}),e.jsx("td",{children:(d.role==="tpo_admin"||d.role==="management_admin"||d.role==="superuser")&&e.jsx(v,{to:d.role==="tpo_admin"?`/tpo/user/${s.id}`:d.role==="management_admin"?`/management/user/${s.id}`:d.role==="superuser"?`/admin/user/${s.id}`:"#",target:"_blank",className:"text-blue-500 no-underline hover:text-blue-700",children:s.name})}),e.jsx("td",{children:s.email}),e.jsx("td",{children:((i=(n=s==null?void 0:s.currentRound)==null?void 0:n.charAt(0))==null?void 0:i.toUpperCase())+((p=s==null?void 0:s.currentRound)==null?void 0:p.slice(1))||"-"}),e.jsx("td",{children:s.status.charAt(0).toUpperCase()+s.status.slice(1)}),e.jsx("td",{children:new Date(s.appliedAt).toLocaleString("en-IN")})]},a)})}):e.jsx("tr",{children:e.jsx("td",{colSpan:6,children:"No Student Yet Applied!"})})})]})})]})})})})]}),e.jsx("div",{className:"",children:e.jsx(h,{defaultActiveKey:["1"],alwaysOpen:!0,className:"shadow rounded",children:e.jsxs(h.Item,{eventKey:"1",children:[e.jsx(h.Header,{children:"Job Details"}),e.jsx(h.Body,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col backdrop-blur-md bg-white/30 border border-white/20 rounded-lg px-2 shadow-sm shadow-red-400",children:[e.jsx("span",{className:"text-xl text-blue-500 py-2 border-b-2",children:"Job Title"}),e.jsx("span",{className:"py-3",children:l==null?void 0:l.jobTitle})]}),e.jsxs("div",{className:"flex flex-col backdrop-blur-md bg-white/30 border border-white/20 rounded-lg px-2 shadow-sm shadow-red-400",children:[e.jsx("span",{className:"text-xl text-blue-500 py-2 border-b-2",children:"Job Profile"}),e.jsx("span",{className:"py-3",dangerouslySetInnerHTML:{__html:l==null?void 0:l.jobDescription}})]}),e.jsxs("div",{className:"flex flex-col backdrop-blur-md bg-white/30 border border-white/20 rounded-lg px-2 shadow-sm shadow-red-400",children:[e.jsx("span",{className:"text-xl text-blue-500 py-2 border-b-2",children:"Eligibility"}),e.jsx("span",{className:"py-3",dangerouslySetInnerHTML:{__html:l==null?void 0:l.eligibility}})]}),e.jsxs("div",{className:"flex flex-col backdrop-blur-md bg-white/30 border border-white/20 rounded-lg px-2 shadow-sm shadow-red-400",children:[e.jsx("span",{className:"text-xl text-blue-500 py-2 border-b-2",children:"Annual CTC"}),e.jsxs("span",{className:"py-3",children:[l==null?void 0:l.salary," LPA"]})]}),e.jsxs("div",{className:"flex flex-col backdrop-blur-md bg-white/30 border border-white/20 rounded-lg px-2 shadow-sm shadow-red-400",children:[e.jsx("span",{className:"text-xl text-blue-500 py-2 border-b-2",children:"Last Date of Application"}),e.jsx("span",{className:"py-3",children:new Date(l==null?void 0:l.applicationDeadline).toLocaleDateString("en-IN",{month:"long",year:"numeric",day:"numeric"})})]}),(y===!0||(d==null?void 0:d.role)!=="student")&&e.jsxs("div",{className:"flex flex-col backdrop-blur-md bg-white/30 border border-white/20 rounded-lg px-2 shadow-sm shadow-red-400",children:[e.jsx("span",{className:"text-xl text-blue-500 py-2 border-b-2",children:"How to Apply?"}),e.jsx("span",{className:"py-3",dangerouslySetInnerHTML:{__html:l==null?void 0:l.howToApply}})]}),d.role==="student"&&e.jsx("div",{className:"flex justify-center",children:y===!1?e.jsxs(A,{variant:"warning",onClick:P,children:[e.jsx("i",{className:"fa-solid fa-check px-2"}),"Apply Now"]}):e.jsx(v,{to:`/student/status/${x}`,children:e.jsxs(A,{variant:"warning",children:[e.jsx("i",{className:"fa-solid fa-check px-2"}),"Update Status"]})})})]})})]})})})]})}),e.jsx(W,{show:E,close:K,header:"Confirmation",body:H,btn:"Apply",confirmAction:R})]})}export{de as default};
