import{u as O,a as R,r as i,j as t,b as x,B as f}from"./index-BW9J8XDZ.js";import{T as q}from"./Table-BMev4Dnk.js";import{T as H,O as S,a as L}from"./TablePlaceholder-Ble8dsBU.js";import{M as G}from"./Modal-C3czwkNW.js";import{C as K}from"./Toast-B3EGjjVm.js";import"./ThemeProvider-CkxvoxuK.js";import"./hasClass-Cxr2nBO8.js";import"./TransitionWrapper-C8SpBI9G.js";import"./useEventCallback-Duh4GctK.js";import"./useTimeout-C4AjoZ0W.js";import"./hook-DYghO068.js";import"./Placeholder-lanV48h9.js";import"./Col-ybKDMb82.js";import"./Button-DwHs9q8a.js";import"./Button-2RoaZ0va.js";function he(){document.title="CPMS | All Company";const c=O(),M=R(),[D,j]=i.useState(!0),[l,T]=i.useState({}),[u,E]=i.useState({}),[w,$]=i.useState({companyName:"",companyId:""}),[k,d]=i.useState(!1),[A,h]=i.useState(""),[_,g]=i.useState(!1),[m,B]=i.useState(""),P=async()=>{var e;try{const r=localStorage.getItem("token"),s=await x.get(`${f}/user/detail`,{headers:{Authorization:`Bearer ${r}`}});s!=null&&s.data&&B((e=s==null?void 0:s.data)==null?void 0:e.role)}catch(r){console.log("Account.jsx => ",r)}},b=async()=>{var e,r;try{const s=localStorage.getItem("token"),a=await x.get(`${f}/company/company-detail`,{headers:{Authorization:`Bearer ${s}`}});T(a.data.companys),j(!1)}catch(s){console.log("Error fetching jobs ",s),(r=(e=s==null?void 0:s.response)==null?void 0:e.data)!=null&&r.msg&&(h(s.response.data.msg),d(!0))}},I=(e,r)=>{$({companyId:r,companyName:e}),g(!0)},z=async e=>{var r,s,a,v,N,p;try{const o=localStorage.getItem("token"),n=await x.post(`${f}/company/delete-company`,{companyId:e},{headers:{Authorization:`Bearer ${o}`}});g(!1),b(),(r=n==null?void 0:n.data)!=null&&r.msg&&(h((s=n==null?void 0:n.data)==null?void 0:s.msg),d(!0)),j(!1)}catch(o){(v=(a=o==null?void 0:o.response)==null?void 0:a.data)!=null&&v.msg&&(h((p=(N=o==null?void 0:o.response)==null?void 0:N.data)==null?void 0:p.msg),d(!0)),console.log("Error deleting job ",o)}},J=async()=>{var e,r;try{const s=await x.get(`${f}/tpo/jobs`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});E(s.data.data)}catch(s){console.log("Error fetching jobs ",s),(r=(e=s==null?void 0:s.response)==null?void 0:e.data)!=null&&r.msg&&(h(s.response.data.msg),d(!0))}},U=e=>t.jsx(L,{id:"button-tooltip",...e,children:"Delete Company"}),y=e=>t.jsx(L,{id:"button-tooltip",...e,children:"Edit Company"}),W=()=>g(!1),{showToastPass:C,toastMessagePass:F}=M.state||{showToastPass:!1,toastMessagePass:""};return i.useEffect(()=>{C&&(h(F),d(C),c(".",{replace:!0,state:{}})),P(),b(),J()},[]),t.jsx(t.Fragment,{children:t.jsxs(t.Fragment,{children:[t.jsx(K,{show:k,onClose:()=>d(!1),message:A,delay:3e3,position:"bottom-end"}),t.jsx("div",{className:"",children:D?t.jsx(H,{}):t.jsxs(q,{striped:!0,bordered:!0,hover:!0,responsive:"sm",className:"bg-white my-6 rounded-lg shadow w-full text-base max-sm:text-sm max-sm:my-3",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{style:{width:"7%"},children:"Sr. No."}),t.jsx("th",{style:{width:"18%"},children:t.jsx("b",{children:"Company Name"})}),t.jsx("th",{style:{width:"15%"},children:"Company Website"}),t.jsx("th",{style:{width:"15%"},children:"Company Location"}),t.jsx("th",{style:{width:"17%"},children:"Company Difficulty Level"}),t.jsx("th",{style:{width:"13%"},children:"No. of Jobs Posted"}),t.jsx("th",{style:{width:"15%"},children:"Action"})]})}),t.jsx("tbody",{children:(l==null?void 0:l.length)>0?l==null?void 0:l.map((e,r)=>{var s;return t.jsxs("tr",{children:[t.jsx("td",{children:r+1}),t.jsx("td",{children:t.jsx("b",{children:e==null?void 0:e.companyName})}),t.jsx("td",{children:t.jsx("a",{href:e==null?void 0:e.companyWebsite,target:"_blank",className:"text-blue-500 no-underline",rel:"noopener noreferrer",children:e==null?void 0:e.companyWebsite})}),t.jsx("td",{children:e==null?void 0:e.companyLocation}),t.jsxs("td",{children:[(e==null?void 0:e.companyDifficulty)==="Easy"&&t.jsx("span",{className:"bg-green-500 text-white px-2 py-1 rounded",children:e==null?void 0:e.companyDifficulty}),(e==null?void 0:e.companyDifficulty)==="Moderate"&&t.jsx("span",{className:"bg-orange-500 text-white px-2 py-1 rounded",children:e==null?void 0:e.companyDifficulty}),(e==null?void 0:e.companyDifficulty)==="Hard"&&t.jsx("span",{className:"bg-red-500 text-white px-2 py-1 rounded",children:e==null?void 0:e.companyDifficulty})]}),t.jsx("td",{children:u.length?(s=u==null?void 0:u.filter(a=>(a==null?void 0:a.company)==(e==null?void 0:e._id)))==null?void 0:s.length:""}),t.jsx("td",{children:t.jsxs("div",{className:"flex justify-around items-center max-sm:flex-col max-sm:gap-1",children:[t.jsx("div",{className:"px-0.5",children:t.jsx(S,{placement:"top",delay:{show:250,hide:400},overlay:y,children:t.jsx("i",{className:"fa-regular fa-pen-to-square text-2xl max-sm:text-lg cursor-pointer transition-colors duration-200 ease-in-out hover:text-blue-500",onClick:()=>{m==="tpo_admin"?c(`../tpo/add-company/${e._id}`):m==="management_admin"?c(`../management/add-company/${e._id}`):m==="superuser"&&c(`../admin/add-company/${e._id}`)},onMouseEnter:a=>{a.target.classList.add("fa-solid"),a.target.classList.remove("fa-regular")},onMouseLeave:a=>{a.target.classList.add("fa-regular"),a.target.classList.remove("fa-solid")}})})}),t.jsx("div",{className:"px-0.5",children:t.jsx(S,{placement:"top",delay:{show:250,hide:400},overlay:U,children:t.jsx("i",{className:"fa-regular fa-trash-can text-2xl max-sm:text-lg cursor-pointer transition-colors duration-200 ease-in-out hover:text-red-500",onClick:()=>I(e==null?void 0:e.companyName,e==null?void 0:e._id),onMouseEnter:a=>{a.target.classList.add("fa-solid"),a.target.classList.remove("fa-regular")},onMouseLeave:a=>{a.target.classList.add("fa-regular"),a.target.classList.remove("fa-solid")}})})})]})})]},e==null?void 0:e._id)}):t.jsx("tr",{children:t.jsx("td",{colSpan:"7",children:"No Jobs found"})})})]})}),t.jsx(G,{show:_,close:W,header:"Confirmation",body:`Do you want to delete company ${w.companyName}?`,btn:"Delete",confirmAction:()=>z(w.companyId)})]})})}export{he as default};
