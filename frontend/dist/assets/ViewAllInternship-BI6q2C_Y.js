import{u as F,a as O,r as d,b as i,B as f,j as e}from"./index-BW9J8XDZ.js";import{T as p}from"./Table-BMev4Dnk.js";import{T as q,O as b,a as S}from"./TablePlaceholder-Ble8dsBU.js";import{M as Y}from"./Modal-C3czwkNW.js";import{C as G}from"./Toast-B3EGjjVm.js";import"./ThemeProvider-CkxvoxuK.js";import"./hasClass-Cxr2nBO8.js";import"./TransitionWrapper-C8SpBI9G.js";import"./useEventCallback-Duh4GctK.js";import"./useTimeout-C4AjoZ0W.js";import"./hook-DYghO068.js";import"./Placeholder-lanV48h9.js";import"./Col-ybKDMb82.js";import"./Button-DwHs9q8a.js";import"./Button-2RoaZ0va.js";function ct(){document.title="CPMS | My Internships";const j=F(),v=O(),[I,D]=d.useState(!0),[m,M]=d.useState([]),[N,r]=d.useState(!1),[T,u]=d.useState(""),[L,n]=d.useState(!1),[E,C]=d.useState({}),[A,$]=d.useState(""),[c,B]=d.useState({});d.useEffect(()=>{const t=localStorage.getItem("token");i.get(`${f}/user/detail`,{headers:{Authorization:`Bearer ${t}`}}).then(o=>{B({id:o.data.id,email:o.data.email,role:o.data.role})}).catch(o=>{console.log("AddUserTable.jsx => ",o),u(o),r(!0)}),g()},[]);const g=async()=>{var t,o,a,x;try{if(!(c!=null&&c.id))return;const s=await i.get(`${f}/student/internship?studentId=${c==null?void 0:c.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});M(s.data.internships),(t=s==null?void 0:s.data)!=null&&t.msg&&(u((o=s==null?void 0:s.data)==null?void 0:o.msg),r(!0)),D(!1)}catch(s){console.log("Error fetching jobs ",s),(x=(a=s==null?void 0:s.response)==null?void 0:a.data)!=null&&x.msg&&(u(s.response.data.msg),r(!0))}};d.useEffect(()=>{g()},[c==null?void 0:c.id]);const P=(t,o)=>{$(t),C({cmpName:o}),n(!0)},k=async t=>{var o,a,x,s,y,w;try{const l=await i.post(`${f}/student/delete-internship`,{internshipId:t,studentId:c.id},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});n(!1),g(),(o=l==null?void 0:l.data)!=null&&o.msg&&(u((a=l==null?void 0:l.data)==null?void 0:a.msg),r(!0))}catch(l){(s=(x=l==null?void 0:l.response)==null?void 0:x.data)!=null&&s.msg&&(u((w=(y=l==null?void 0:l.response)==null?void 0:y.data)==null?void 0:w.msg),r(!0)),console.log("Error deleting job ",l)}},_=t=>e.jsx(S,{id:"button-tooltip",...t,children:"Edit Internship Detail"}),W=t=>e.jsx(S,{id:"button-tooltip",...t,children:"Delete Internship"}),z=()=>n(!1),{showToastPass:h,toastMessagePass:R}=v.state||{showToastPass:!1,toastMessagePass:""};return d.useEffect(()=>{h&&(u(R),r(h),j(".",{replace:!0,state:{}}))},[]),e.jsx(e.Fragment,{children:e.jsxs(e.Fragment,{children:[e.jsx(G,{show:N,onClose:()=>r(!1),message:T,delay:3e3,position:"bottom-end"}),e.jsx("div",{className:"",children:I?e.jsx(q,{}):e.jsxs(p,{striped:!0,bordered:!0,hover:!0,responsive:"sm",className:"bg-white my-6 rounded-lg shadow w-full text-base max-lg:text-sm max-md:my-3",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"6%"},children:"Sr. No."}),e.jsx("th",{style:{width:"16%"},children:e.jsx("b",{children:"Company Name"})}),e.jsx("th",{style:{width:"13%"},children:"Company Website"}),e.jsx("th",{style:{width:"14%"},children:"Internship Start Date"}),e.jsx("th",{style:{width:"14%"},children:"Internship End Date"}),e.jsx("th",{style:{width:"13%"},children:"Internship Duration"}),e.jsx("th",{style:{width:"11%"},children:"Monthly Stipend"}),e.jsx("th",{style:{width:"13%"},children:"Action"})]})}),e.jsx("tbody",{children:(m==null?void 0:m.length)>0?m==null?void 0:m.map((t,o)=>e.jsxs("tr",{children:[e.jsx("td",{children:o+1}),e.jsx("td",{children:e.jsx("b",{children:(t==null?void 0:t.companyName)||"-"})}),e.jsx("td",{children:t!=null&&t.companyWebsite?e.jsx("a",{href:t==null?void 0:t.companyWebsite,target:"_blanck",className:"no-underline text-blue-500 hover:text-blue-700",children:t==null?void 0:t.companyWebsite}):"-"}),e.jsx("td",{children:new Date(t==null?void 0:t.startDate).toLocaleDateString("en-IN")||"-"}),e.jsx("td",{children:new Date(t==null?void 0:t.endDate).toLocaleDateString("en-IN")||"-"}),e.jsx("td",{children:t!=null&&t.internshipDuration?(t==null?void 0:t.internshipDuration)+" days":"-"}),e.jsx("td",{children:t!=null&&t.monthlyStipend?"Rs. "+(t==null?void 0:t.monthlyStipend):"-"}),e.jsx("td",{children:e.jsxs("div",{className:"flex justify-around items-center max-lg:flex-col max-lg:gap-1",children:[e.jsx("div",{className:"px-0.5",children:e.jsx(b,{placement:"top",delay:{show:250,hide:400},overlay:_,children:e.jsx("i",{className:"fa-regular fa-pen-to-square text-2xl cursor-pointer transition-colors duration-200 ease-in-out hover:text-blue-500",onClick:()=>j(`../student/add-internship/${t._id}`),onMouseEnter:a=>{a.target.classList.add("fa-solid"),a.target.classList.remove("fa-regular")},onMouseLeave:a=>{a.target.classList.add("fa-regular"),a.target.classList.remove("fa-solid")}})})}),e.jsx("div",{className:"px-0.5",children:e.jsx(b,{placement:"top",delay:{show:250,hide:400},overlay:W,children:e.jsx("i",{className:"fa-regular fa-trash-can text-2xl cursor-pointer transition-colors duration-200 ease-in-out hover:text-red-500",onClick:()=>P(t==null?void 0:t._id,t==null?void 0:t.companyName),onMouseEnter:a=>{a.target.classList.add("fa-solid"),a.target.classList.remove("fa-regular")},onMouseLeave:a=>{a.target.classList.add("fa-regular"),a.target.classList.remove("fa-solid")}})})})]})})]},t==null?void 0:t._id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"Internship Not Added Yet!"})})})]})}),e.jsx(Y,{show:L,close:z,header:"Confirmation",body:`Do you want to delete internship of ${E.cmpName}?`,btn:"Delete",confirmAction:()=>k(A)})]})})}export{ct as default};
