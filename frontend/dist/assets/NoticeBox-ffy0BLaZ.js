import{r as o,b as n,B as r,j as l,c as i}from"./index-BW9J8XDZ.js";import{B as g}from"./Badge-DWmDE_gp.js";function u(){const[m,h]=o.useState(!0),[d,x]=o.useState([]),[e,f]=o.useState({});o.useEffect(()=>{(async()=>{try{const t=localStorage.getItem("token"),s=await n.get(`${r}/user/detail`,{headers:{Authorization:`Bearer ${t}`}});f({role:s.data.role})}catch(t){console.log("Error fetching user details => ",t)}})()},[]),o.useEffect(()=>{e!=null&&e.role&&c()},[e==null?void 0:e.role]);const c=async()=>{try{const a=await n.get(`${r}/management/get-all-notices`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});let t=[];(e==null?void 0:e.role)==="management_admin"?t=a.data.filter(s=>s.sender_role==="tpo_admin"):(e==null?void 0:e.role)==="tpo_admin"?t=a.data.filter(s=>s.receiver_role==="tpo_admin"):(e==null?void 0:e.role)==="student"&&(t=a.data.filter(s=>s.receiver_role==="student")),x(t)}catch(a){console.log("Error while fetching notices => ",a)}finally{h(!1)}};return l.jsxs("div",{className:"my-2 mx-2 w-full backdrop-blur-md bg-white/30 border border-white/20 rounded-lg py-2 px-3 shadow shadow-red-400",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("h3",{className:"font-semibold my-2",children:"Notice"}),l.jsxs("span",{className:"",children:[(e==null?void 0:e.role)==="student"&&l.jsx(i,{to:"/student/all-notice",className:"no-underline text-blue-500 hover:text-blue-700",children:"View All"}),(e==null?void 0:e.role)==="tpo_admin"&&l.jsx(i,{to:"/tpo/all-notice",className:"no-underline text-blue-500 hover:text-blue-700",children:"View All"}),(e==null?void 0:e.role)==="management_admin"&&l.jsx(i,{to:"/management/all-notice",className:"no-underline text-blue-500 hover:text-blue-700",children:"View All"})]})]}),m?l.jsx("div",{className:"flex justify-center items-center",children:l.jsx("i",{className:"fa-solid fa-spinner fa-spin text-2xl"})}):l.jsx("div",{className:"relative h-72 overflow-hidden",children:l.jsx("div",{className:"absolute bottom-0 w-full h-full animate-scrollUp",children:(d==null?void 0:d.length)>0?d.map((a,t)=>l.jsxs("div",{className:"py-2 h-fit",children:[l.jsxs(i,{className:"text-blue-500 hover:text-blue-700",to:(e==null?void 0:e.role)==="student"?`/student/notice/${a==null?void 0:a._id}`:(e==null?void 0:e.role)==="tpo_admin"?`/tpo/notice/${a==null?void 0:a._id}`:e.role==="management_admin"?`/management/notice/${a==null?void 0:a._id}`:"",target:"_blank",children:[a==null?void 0:a.title,(new Date-new Date(a==null?void 0:a.createdAt))/(1e3*60*60*24)<=2&&l.jsx(g,{className:"mx-2",bg:"primary",children:"New"})]}),l.jsx("span",{className:"no-underline mx-1 text-gray-400",children:new Date(a==null?void 0:a.createdAt).toLocaleDateString("en-IN")+" "+new Date(a==null?void 0:a.createdAt).toLocaleTimeString("en-IN")})]},t)):l.jsx("div",{children:"No notices found!"})})})]})}export{u as N};
